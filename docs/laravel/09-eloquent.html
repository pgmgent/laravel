<!DOCTYPE html>
<html lang="nl-BE">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CRUD via Eloquent ORM | Framework Development &amp; Laravel</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link href="https://www.gdm.gent/vuepress-theme-artevelde/favicon.svg" rel="icon">
    <meta name="description" content="Advanced Development with PHP &amp; MVC with Laravel">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    
    <link rel="preload" href="/laravel/assets/css/0.styles.0244fdd9.css" as="style"><link rel="preload" href="/laravel/assets/js/app.6797ef22.js" as="script"><link rel="preload" href="/laravel/assets/js/2.7ca25b29.js" as="script"><link rel="preload" href="/laravel/assets/js/38.721227d1.js" as="script"><link rel="preload" href="/laravel/assets/js/5.861211ff.js" as="script"><link rel="preload" href="/laravel/assets/js/20.21de2408.js" as="script"><link rel="preload" href="/laravel/assets/js/3.19667c3e.js" as="script"><link rel="prefetch" href="/laravel/assets/js/10.5e9ac10c.js"><link rel="prefetch" href="/laravel/assets/js/11.da89dc38.js"><link rel="prefetch" href="/laravel/assets/js/12.f75538b0.js"><link rel="prefetch" href="/laravel/assets/js/13.f6363d8f.js"><link rel="prefetch" href="/laravel/assets/js/14.17d6117b.js"><link rel="prefetch" href="/laravel/assets/js/15.fc4a971d.js"><link rel="prefetch" href="/laravel/assets/js/16.7a52b460.js"><link rel="prefetch" href="/laravel/assets/js/17.3743a231.js"><link rel="prefetch" href="/laravel/assets/js/18.e103b0bd.js"><link rel="prefetch" href="/laravel/assets/js/19.0db8ae57.js"><link rel="prefetch" href="/laravel/assets/js/21.8d175336.js"><link rel="prefetch" href="/laravel/assets/js/22.81430f94.js"><link rel="prefetch" href="/laravel/assets/js/23.19310e90.js"><link rel="prefetch" href="/laravel/assets/js/24.b5a983f1.js"><link rel="prefetch" href="/laravel/assets/js/25.2a38243c.js"><link rel="prefetch" href="/laravel/assets/js/26.32635031.js"><link rel="prefetch" href="/laravel/assets/js/27.8ac1c312.js"><link rel="prefetch" href="/laravel/assets/js/28.d020e68a.js"><link rel="prefetch" href="/laravel/assets/js/29.e1ce3a40.js"><link rel="prefetch" href="/laravel/assets/js/30.5608092b.js"><link rel="prefetch" href="/laravel/assets/js/31.f0f73cb8.js"><link rel="prefetch" href="/laravel/assets/js/32.a9fd8090.js"><link rel="prefetch" href="/laravel/assets/js/33.60331d6b.js"><link rel="prefetch" href="/laravel/assets/js/34.ea9ecbca.js"><link rel="prefetch" href="/laravel/assets/js/35.729a9fe3.js"><link rel="prefetch" href="/laravel/assets/js/36.53794cfd.js"><link rel="prefetch" href="/laravel/assets/js/37.c7dd25d1.js"><link rel="prefetch" href="/laravel/assets/js/39.f5ff31ab.js"><link rel="prefetch" href="/laravel/assets/js/4.9b20a6cc.js"><link rel="prefetch" href="/laravel/assets/js/40.51505397.js"><link rel="prefetch" href="/laravel/assets/js/41.ec97a266.js"><link rel="prefetch" href="/laravel/assets/js/42.5aac49ed.js"><link rel="prefetch" href="/laravel/assets/js/43.2dadb86c.js"><link rel="prefetch" href="/laravel/assets/js/44.396944d7.js"><link rel="prefetch" href="/laravel/assets/js/6.77d8c133.js"><link rel="prefetch" href="/laravel/assets/js/7.e7c0de10.js"><link rel="prefetch" href="/laravel/assets/js/8.22bf2da1.js"><link rel="prefetch" href="/laravel/assets/js/9.e67ff90f.js">
    <link rel="stylesheet" href="/laravel/assets/css/0.styles.0244fdd9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="navbar-item"><div class="sidebar-button"><svg fill="currentColor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg" class="sidebar-icon sidebar-closing-icon"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"></path> <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"></path></svg> <svg fill="currentColor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg" class="sidebar-icon sidebar-opening-icon"><path fill-rule="evenodd" d="M2.5 11.5A.5.5 0 0 1 3 11h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 3h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"></path></svg></div></div> <a href="/laravel/" class="navbar-item home-link router-link-active"><img src="https://www.gdm.gent/vuepress-theme-artevelde/artevelde__icon--white.svg" alt="Framework Development &amp; Laravel" class="logo"> <span class="site-name">Framework Development &amp; Laravel</span></a> <div class="search-box navbar-item"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links navbar-item can-hide"><div class="nav-item"><a href="/laravel/composer/" class="nav-link">Composer</a></div><div class="nav-item"><a href="/laravel/laravel/" class="nav-link router-link-active">Laravel</a></div><div class="nav-item"><a href="/laravel/mailing/" class="nav-link">Mailing</a></div><div class="nav-item"><a href="/laravel/deployment/" class="nav-link">Deployment</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Taal</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel/laravel/09-eloquent.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">Nederlands</a></li><li class="dropdown-item"><!----> <a href="/laravel/en/" class="nav-link">English</a></li></ul></div></div> <!----> <!----></nav></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/laravel/composer/" class="nav-link">Composer</a></div><div class="nav-item"><a href="/laravel/laravel/" class="nav-link router-link-active">Laravel</a></div><div class="nav-item"><a href="/laravel/mailing/" class="nav-link">Mailing</a></div><div class="nav-item"><a href="/laravel/deployment/" class="nav-link">Deployment</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Taal</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel/laravel/09-eloquent.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">Nederlands</a></li><li class="dropdown-item"><!----> <a href="/laravel/en/" class="nav-link">English</a></li></ul></div></div> <!----> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/laravel/laravel/" class="router-link-active sidebar-heading clickable open"><span>Laravel MVC Framework</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/laravel/laravel/01-frameworks.html" class="sidebar-link">PHP Frameworks</a></li><li><a href="/laravel/laravel/02-installation.html" class="sidebar-link">Installatie</a></li><li><a href="/laravel/laravel/03-mvc.html" class="sidebar-link">Model View Controller</a></li><li><a href="/laravel/laravel/04-asset-linking.html" class="sidebar-link">Linking assets</a></li><li><a href="/laravel/laravel/05-database-migrations.html" class="sidebar-link">Migrations</a></li><li><a href="/laravel/laravel/06-relations.html" class="sidebar-link">Relaties</a></li><li><a href="/laravel/laravel/07-storage.html" class="sidebar-link">File Storage</a></li><li><a href="/laravel/laravel/08-authentication.html" class="sidebar-link">Authenticatie</a></li><li><a href="/laravel/laravel/09-eloquent.html" aria-current="page" class="active sidebar-link">CRUD via Eloquent ORM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/laravel/laravel/09-eloquent.html#basis" class="sidebar-link">Basis</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/09-eloquent.html#query-opbouwen" class="sidebar-link">Query opbouwen</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/09-eloquent.html#aanmaken-van-nieuwe-records" class="sidebar-link">Aanmaken van nieuwe records</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/09-eloquent.html#record-aanpassen" class="sidebar-link">Record aanpassen</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/09-eloquent.html#verwijderen" class="sidebar-link">Verwijderen</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/09-eloquent.html#soft-delete-of-zacht-verwijderen" class="sidebar-link">Soft delete of zacht verwijderen</a></li></ul></li><li><a href="/laravel/laravel/10-forms-validation.html" class="sidebar-link">Formulieren</a></li><li><a href="/laravel/laravel/11-localization.html" class="sidebar-link">Localization</a></li><li><a href="/laravel/laravel/12-api.html" class="sidebar-link">API</a></li><li><a href="/laravel/laravel/13-cheatsheet.html" class="sidebar-link">Cheat Sheet</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="crud-via-eloquent-orm"><a href="#crud-via-eloquent-orm" class="header-anchor">#</a> CRUD via Eloquent ORM</h1> <p>Laravel maakt gebruik van een Object-relational mapper (ORM) om eenvoudig interactie te hebben met de database.</p> <p>Een ORM vertaald relationele data om naar object georiënteerde programma code.</p> <p>Dit om het schrijven van SQL statements te vereenvoudigen en de kans op SQL Injecten te verkleinen.</p> <p>Je kan het vergelijken met <code>TypeORM</code> or <code>Prisma</code> binnen Node.js</p> <h2 id="basis"><a href="#basis" class="header-anchor">#</a> Basis</h2> <p>Standaard wordt ieder Model uitgerust met de methods die gebruik maken van dit ORM. Het ORM zorgt er dus voor dat database records worden omgevormd naar Objecten die we kunnen gebruiken.</p> <p>Zo hebben we reeds de methods <code>all()</code> en <code>find()</code> gezien bij de introductie:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//Alle records ophalen
$projects = Project::all();
var_dump($projects);

//Het vak ophalen met primary key 1
$project = Project::find(1);
var_dump($project);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Uiteraard zullen applicaties gebruik maken van meer uitdagende SQL queries om data op te halen.</p> <h2 id="query-opbouwen"><a href="#query-opbouwen" class="header-anchor">#</a> Query opbouwen</h2> <p>Een query opbouwen kan je vergelijken met het schrijven van een sql query. Het grootste verschil is vooral dat de volgorde bij SQL altijd gerespecteerd moet worden. Maar bij het opbouwen via de Eloquent ORM is dat niet meer van belang. Hoewel het me logisch en leesbaar lijkt om dit nog steeds te behouden.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT * FROM projects 
WHERE publish = 1 AND company_id = 4
ORDER BY name ASC
LIMIT 20
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Als we bovenstaande SQL statement in Laravel willen opbouwen via een Model <code>Project</code> dan zal dit als volgt gebeuren.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$projects = Project::where('publish', 1)
            -&gt;where('company_id', 4)
            -&gt;orderBy('name', 'DESC')
            -&gt;limit(20)
            -&gt;get();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Indien je queries moet uitvoeren dat ruimer zijn dan 1 model of indien er geen model is kan je ook de <code>DB</code> Model gebruiken hiervoor</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$projects = DB::table('projects')
                -&gt;where('publish', 1)
                -&gt;where('company_id', 4)
                -&gt;orderBy('name', 'DESC')
                -&gt;limit(20)
                -&gt;get();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><a href="https://laravel.com/docs/9.x/queries#limit-and-offset" target="_blank" rel="noopener noreferrer">Een volledig overzicht van de mogelijkheden kan je terugvinden op de Laravel handleiding<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="aanmaken-van-nieuwe-records"><a href="#aanmaken-van-nieuwe-records" class="header-anchor">#</a> Aanmaken van nieuwe records</h2> <p>Via de models kan je ook eenvoudig een nieuw record aanmaken in de database.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$project = new Project();
$project-&gt;name = 'My new project';
$project-&gt;description = 'Full description of the project...';
$project-&gt;publish = 1;
$project-&gt;customer_id = 4;
$project-&gt;save();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="record-aanpassen"><a href="#record-aanpassen" class="header-anchor">#</a> Record aanpassen</h2> <p>Hetzelfde kunnen we doen voor het aanpassen van een record.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$project = Project::find(123);
$project-&gt;customer_id = 2;
$project-&gt;save();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="verwijderen"><a href="#verwijderen" class="header-anchor">#</a> Verwijderen</h2> <p>Het verwijderen van 1 record komt overeen met het wijzigen, maar uiteraard met gebruik van de delete method.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$project = Project::find(123);
$project-&gt;delete();

// Of korter geschreven
Project::find(123)-&gt;delete();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Je kan ook meerdere records dat voldoen aan een zoekopdracht in 1 actie verwijderen.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//Alle projecten van klant met id 4 uit de database verwijderen
Project::where('customer_id', 4)-&gt;delete();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>Let op!</strong> Bij het verwijderen van records zijn die ook meteen verdwenen. Een soort prullenmand bestaat niet echt binnen MySQL.</p> <h2 id="soft-delete-of-zacht-verwijderen"><a href="#soft-delete-of-zacht-verwijderen" class="header-anchor">#</a> Soft delete of zacht verwijderen</h2> <p>Laravel heeft wel een ingebouwde manier om records niet meteen te wissen.</p> <p>Hierbij wordt een extra kolom toegevoegd <code>deleted_at</code>. Indien een record verwijderd is zal hier de datum ingevuld worden. Het records zal dus blijven bestaan in de database maar zal niet meer opgehaald worden bij een gewone <code>get()</code> of <code>find()</code>.</p> <p>In je model moet je aangeven dat deze werkt via zo een soft delete:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;?php
 
namespace App\Models;
 
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;
 
class Project extends Model
{
    use SoftDeletes;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Uiteraard moet ook eerst de <code>deleted_at</code> kolom aangemaakt worden. Dit kan via een migration.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Schema::table('projects', function (Blueprint $table) {
    $table-&gt;softDeletes();
});
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <div class="page-nav"><div class="inner"><a href="/laravel/laravel/08-authentication.html" class="btn btn-left" data-v-3bc6a301><svg fill="currentColor" class="icon bi" data-v-6414aa66><use xlink:href="/laravel/assets/img/bootstrap-icons.56d35f89.svg#arrow-left" data-v-6414aa66></use></svg> Authenticatie <!----></a> <a href="/laravel/laravel/10-forms-validation.html" class="btn btn-right" data-v-3bc6a301><!----> Formulieren <svg fill="currentColor" class="icon bi" data-v-6414aa66 data-v-3bc6a301><use xlink:href="/laravel/assets/img/bootstrap-icons.56d35f89.svg#arrow-right" data-v-6414aa66></use></svg></a></div></div> <footer class="page-edit"><span class="copyright">© 2023 Arteveldehogeschool</span> <!----> <!----></footer> </main></div><div class="global-ui"></div></div>
    <script src="/laravel/assets/js/app.6797ef22.js" defer></script><script src="/laravel/assets/js/2.7ca25b29.js" defer></script><script src="/laravel/assets/js/38.721227d1.js" defer></script><script src="/laravel/assets/js/5.861211ff.js" defer></script><script src="/laravel/assets/js/20.21de2408.js" defer></script><script src="/laravel/assets/js/3.19667c3e.js" defer></script>
  </body>
</html>
