<!DOCTYPE html>
<html lang="nl-BE">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mollie payment | Advanced Development &amp; Laravel</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link href="https://www.gdm.gent/vuepress-theme-artevelde/favicon.svg" rel="icon">
    <meta name="description" content="Advanced Development with PHP &amp; MVC with Laravel">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    
    <link rel="preload" href="/laravel/assets/css/0.styles.0b454ba6.css" as="style"><link rel="preload" href="/laravel/assets/js/app.9fc9bfe7.js" as="script"><link rel="preload" href="/laravel/assets/js/2.f4ff8d09.js" as="script"><link rel="preload" href="/laravel/assets/js/1.6dc52488.js" as="script"><link rel="preload" href="/laravel/assets/js/90.b9c6d33f.js" as="script"><link rel="preload" href="/laravel/assets/js/6.8ae372e2.js" as="script"><link rel="preload" href="/laravel/assets/js/21.a94f78e3.js" as="script"><link rel="preload" href="/laravel/assets/js/4.abda3fa6.js" as="script"><link rel="prefetch" href="/laravel/assets/js/10.980aae0d.js"><link rel="prefetch" href="/laravel/assets/js/11.35b22657.js"><link rel="prefetch" href="/laravel/assets/js/12.dda749b6.js"><link rel="prefetch" href="/laravel/assets/js/13.779b3073.js"><link rel="prefetch" href="/laravel/assets/js/14.f900b80d.js"><link rel="prefetch" href="/laravel/assets/js/15.40faa082.js"><link rel="prefetch" href="/laravel/assets/js/16.3327abf8.js"><link rel="prefetch" href="/laravel/assets/js/17.e4ba189e.js"><link rel="prefetch" href="/laravel/assets/js/18.73e497ac.js"><link rel="prefetch" href="/laravel/assets/js/19.e8db1473.js"><link rel="prefetch" href="/laravel/assets/js/20.53560cb0.js"><link rel="prefetch" href="/laravel/assets/js/22.0cc103e5.js"><link rel="prefetch" href="/laravel/assets/js/23.acff0979.js"><link rel="prefetch" href="/laravel/assets/js/24.d9d364b0.js"><link rel="prefetch" href="/laravel/assets/js/25.c50b9c7f.js"><link rel="prefetch" href="/laravel/assets/js/26.67a052fc.js"><link rel="prefetch" href="/laravel/assets/js/28.98c20a32.js"><link rel="prefetch" href="/laravel/assets/js/29.4e6e5ef8.js"><link rel="prefetch" href="/laravel/assets/js/3.f0dc286f.js"><link rel="prefetch" href="/laravel/assets/js/30.c53a1ce4.js"><link rel="prefetch" href="/laravel/assets/js/31.9d17ced0.js"><link rel="prefetch" href="/laravel/assets/js/32.3d5e2303.js"><link rel="prefetch" href="/laravel/assets/js/33.5a5903d4.js"><link rel="prefetch" href="/laravel/assets/js/34.c389fff7.js"><link rel="prefetch" href="/laravel/assets/js/35.fbdd6f8d.js"><link rel="prefetch" href="/laravel/assets/js/36.a7015d9e.js"><link rel="prefetch" href="/laravel/assets/js/37.6dd6ece2.js"><link rel="prefetch" href="/laravel/assets/js/38.66286f38.js"><link rel="prefetch" href="/laravel/assets/js/39.7426c0de.js"><link rel="prefetch" href="/laravel/assets/js/40.798dba5a.js"><link rel="prefetch" href="/laravel/assets/js/41.b457ff72.js"><link rel="prefetch" href="/laravel/assets/js/42.f45c60ad.js"><link rel="prefetch" href="/laravel/assets/js/43.ce325db2.js"><link rel="prefetch" href="/laravel/assets/js/44.bbe0f710.js"><link rel="prefetch" href="/laravel/assets/js/45.b3bfdec9.js"><link rel="prefetch" href="/laravel/assets/js/46.9f2808e6.js"><link rel="prefetch" href="/laravel/assets/js/47.ed7d1cfc.js"><link rel="prefetch" href="/laravel/assets/js/48.adee4aec.js"><link rel="prefetch" href="/laravel/assets/js/49.49a99597.js"><link rel="prefetch" href="/laravel/assets/js/5.30e088e2.js"><link rel="prefetch" href="/laravel/assets/js/50.e415a4c6.js"><link rel="prefetch" href="/laravel/assets/js/51.1d4c2048.js"><link rel="prefetch" href="/laravel/assets/js/52.f633020e.js"><link rel="prefetch" href="/laravel/assets/js/53.fd94a520.js"><link rel="prefetch" href="/laravel/assets/js/54.6c9f7464.js"><link rel="prefetch" href="/laravel/assets/js/55.283f80f5.js"><link rel="prefetch" href="/laravel/assets/js/56.b3114732.js"><link rel="prefetch" href="/laravel/assets/js/57.3df0e198.js"><link rel="prefetch" href="/laravel/assets/js/58.a889111d.js"><link rel="prefetch" href="/laravel/assets/js/59.68cb61e4.js"><link rel="prefetch" href="/laravel/assets/js/60.21089a05.js"><link rel="prefetch" href="/laravel/assets/js/61.f7dc2a7d.js"><link rel="prefetch" href="/laravel/assets/js/62.b1a77f0a.js"><link rel="prefetch" href="/laravel/assets/js/63.c01eb714.js"><link rel="prefetch" href="/laravel/assets/js/64.2801374a.js"><link rel="prefetch" href="/laravel/assets/js/65.61ba0f16.js"><link rel="prefetch" href="/laravel/assets/js/66.bc1d23aa.js"><link rel="prefetch" href="/laravel/assets/js/67.5e97f8bd.js"><link rel="prefetch" href="/laravel/assets/js/68.183b9698.js"><link rel="prefetch" href="/laravel/assets/js/69.638ee202.js"><link rel="prefetch" href="/laravel/assets/js/7.20738dfe.js"><link rel="prefetch" href="/laravel/assets/js/70.b79e5feb.js"><link rel="prefetch" href="/laravel/assets/js/71.249e3f10.js"><link rel="prefetch" href="/laravel/assets/js/72.2519e80d.js"><link rel="prefetch" href="/laravel/assets/js/73.a86f9281.js"><link rel="prefetch" href="/laravel/assets/js/74.af4b3d3c.js"><link rel="prefetch" href="/laravel/assets/js/75.63b49b68.js"><link rel="prefetch" href="/laravel/assets/js/76.f4d26d3c.js"><link rel="prefetch" href="/laravel/assets/js/77.02a800bd.js"><link rel="prefetch" href="/laravel/assets/js/78.b0491555.js"><link rel="prefetch" href="/laravel/assets/js/79.4d303612.js"><link rel="prefetch" href="/laravel/assets/js/8.0423f836.js"><link rel="prefetch" href="/laravel/assets/js/80.67bbd776.js"><link rel="prefetch" href="/laravel/assets/js/81.86024e31.js"><link rel="prefetch" href="/laravel/assets/js/82.6f1fdbda.js"><link rel="prefetch" href="/laravel/assets/js/83.6b59acfb.js"><link rel="prefetch" href="/laravel/assets/js/84.332976c4.js"><link rel="prefetch" href="/laravel/assets/js/85.35d354b8.js"><link rel="prefetch" href="/laravel/assets/js/86.5c7df381.js"><link rel="prefetch" href="/laravel/assets/js/87.d4bb09a6.js"><link rel="prefetch" href="/laravel/assets/js/88.2e5787cc.js"><link rel="prefetch" href="/laravel/assets/js/89.25662e32.js"><link rel="prefetch" href="/laravel/assets/js/9.8f0021fa.js"><link rel="prefetch" href="/laravel/assets/js/91.d7cdeaa6.js"><link rel="prefetch" href="/laravel/assets/js/92.53e2f393.js"><link rel="prefetch" href="/laravel/assets/js/93.2d16aa7e.js"><link rel="prefetch" href="/laravel/assets/js/94.a8669904.js"><link rel="prefetch" href="/laravel/assets/js/95.b733da24.js"><link rel="prefetch" href="/laravel/assets/js/96.efee245c.js">
    <link rel="stylesheet" href="/laravel/assets/css/0.styles.0b454ba6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="navbar-item"><div class="sidebar-button"><svg fill="currentColor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg" class="sidebar-icon sidebar-closing-icon"><path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"></path> <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"></path></svg> <svg fill="currentColor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg" class="sidebar-icon sidebar-opening-icon"><path fill-rule="evenodd" d="M2.5 11.5A.5.5 0 0 1 3 11h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 3h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"></path></svg></div></div> <a href="/laravel/" class="navbar-item home-link router-link-active"><img src="https://www.gdm.gent/vuepress-theme-artevelde/artevelde__icon--white.svg" alt="Advanced Development &amp; Laravel" class="logo"> <span class="site-name">Advanced Development &amp; Laravel</span></a> <div class="search-box navbar-item"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links navbar-item can-hide"><div class="nav-item"><a href="/laravel/concepts/" class="nav-link">Basisconcepten</a></div><div class="nav-item"><a href="/laravel/laravel/" class="nav-link router-link-active">Laravel</a></div><div class="nav-item"><a href="/laravel/mailing/" class="nav-link">Mailing</a></div><div class="nav-item"><a href="/laravel/deployment/" class="nav-link">Deployment</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Taal</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel/laravel/how-to/mollie.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">Nederlands</a></li><li class="dropdown-item"><!----> <a href="/laravel/en/" class="nav-link">English</a></li></ul></div></div> <!----> <!----></nav></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/laravel/concepts/" class="nav-link">Basisconcepten</a></div><div class="nav-item"><a href="/laravel/laravel/" class="nav-link router-link-active">Laravel</a></div><div class="nav-item"><a href="/laravel/mailing/" class="nav-link">Mailing</a></div><div class="nav-item"><a href="/laravel/deployment/" class="nav-link">Deployment</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Taal</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel/laravel/how-to/mollie.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">Nederlands</a></li><li class="dropdown-item"><!----> <a href="/laravel/en/" class="nav-link">English</a></li></ul></div></div> <!----> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/laravel/laravel/" class="router-link-active sidebar-heading clickable open"><span>Laravel</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group depth-1 collapsable is-sub-group"><a href="/laravel/laravel/basics/" class="sidebar-heading clickable"><span>Laravel MVC</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group depth-1 collapsable is-sub-group"><a href="/laravel/laravel/databases/" class="sidebar-heading clickable"><span>Database</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group depth-1 collapsable is-sub-group"><a href="/laravel/laravel/how-to/" class="router-link-active sidebar-heading clickable open"><span>How to</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/laravel/laravel/how-to/artisan.html" class="sidebar-link">Artisan in Laravel?</a></li><li><a href="/laravel/laravel/how-to/seo.html" class="sidebar-link">SEO of Zoekmachine optimalisatie in Laravel</a></li><li><a href="/laravel/laravel/how-to/build-an-api.html" class="sidebar-link">API bouwen</a></li><li><a href="/laravel/laravel/how-to/authentication.html" class="sidebar-link">Authenticatie</a></li><li><a href="/laravel/laravel/how-to/localization.html" class="sidebar-link">Localization</a></li><li><a href="/laravel/laravel/how-to/e-mail.html" class="sidebar-link">Het versturen van e-mail</a></li><li><a href="/laravel/laravel/how-to/mollie.html" aria-current="page" class="active sidebar-link">Mollie payment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/laravel/laravel/how-to/mollie.html#installatie" class="sidebar-link">Installatie</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/how-to/mollie.html#configuratie" class="sidebar-link">Configuratie</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/how-to/mollie.html#gebruik" class="sidebar-link">Gebruik</a></li><li class="sidebar-sub-header"><a href="/laravel/laravel/how-to/mollie.html#test-credit-cards" class="sidebar-link">Test credit cards</a></li></ul></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mollie-payment"><a href="#mollie-payment" class="header-anchor">#</a> Mollie payment</h1> <p>Om online payment toe te voegen aan je project kan je gebruik maken van een payment provider zoals <a href="https://www.mollie.com/nl/" target="_blank" rel="noopener noreferrer">Mollie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="installatie"><a href="#installatie" class="header-anchor">#</a> Installatie</h2> <p>Installeer de Mollie package via composer:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ddev <span class="token function">composer</span> require mollie/mollie-api-php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="configuratie"><a href="#configuratie" class="header-anchor">#</a> Configuratie</h2> <p>Voeg je Mollie API key toe aan je <code>.env</code> bestand:</p> <div class="language-env line-numbers-mode"><pre class="language-text"><code>MOLLIE_API_KEY=your_mollie_api_key_here
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Vervang <code>your_mollie_api_key_here</code> door je daadwerkelijke API (test) key die je kunt vinden in je Mollie dashboard.</p> <p>In je config/services.php bestand, voeg de volgende configuratie toe:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token string single-quoted-string">'mollie'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'key'</span> <span class="token operator">=&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'MOLLIE_API_KEY'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="gebruik"><a href="#gebruik" class="header-anchor">#</a> Gebruik</h2> <p>In je checkout process kan je nu de Mollie API gebruiken om betalingen te verwerken. Hieronder zie je een voorbeeld van een checkout methode in een Laravel controller (bv OrderController ):</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkout</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//Stap 1 maak een order aan in je database met de status 'pending'</span>
    <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token variable">$address</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'address'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token variable">$product_id</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'product_id'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token variable">$amount</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'amount'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span>    
    <span class="token variable">$amount</span> <span class="token operator">=</span> <span class="token variable">$amount</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>

    <span class="token variable">$order</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'name'</span> <span class="token operator">=&gt;</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'address'</span> <span class="token operator">=&gt;</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'address'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'product_id'</span> <span class="token operator">=&gt;</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'product_id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'amount'</span> <span class="token operator">=&gt;</span> <span class="token variable">$amount</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'payment_status'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'pending'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$order</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//Indien er meerdere producten (orderlines) per order zijn moet je hier ook de items toevoegen via een relatie en opslaan via $order-&gt;items()-&gt;saveMany($items)</span>

    <span class="token comment">//Stap 2 maak een betaling aan via de Mollie API</span>
    <span class="token variable">$mollie</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MollieApiClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$mollie</span><span class="token operator">-&gt;</span><span class="token function">setApiKey</span><span class="token punctuation">(</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'services.mollie.key'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$payment</span> <span class="token operator">=</span> <span class="token variable">$mollie</span><span class="token operator">-&gt;</span><span class="token property">payments</span><span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string double-quoted-string">&quot;amount&quot;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
            <span class="token string double-quoted-string">&quot;currency&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;EUR&quot;</span><span class="token punctuation">,</span>
            <span class="token string double-quoted-string">&quot;value&quot;</span> <span class="token operator">=&gt;</span> <span class="token function">number_format</span><span class="token punctuation">(</span><span class="token variable">$amount</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;description&quot;</span> <span class="token operator">=&gt;</span> <span class="token string double-quoted-string">&quot;Order #&quot;</span> <span class="token operator">.</span> <span class="token variable">$order</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;redirectUrl&quot;</span> <span class="token operator">=&gt;</span> <span class="token function">route</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'checkout.success'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'order_id'</span> <span class="token operator">=&gt;</span> <span class="token variable">$order</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;webhookUrl&quot;</span>  <span class="token operator">=&gt;</span> <span class="token function">route</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'checkout.webhook'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;metadata&quot;</span>    <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
            <span class="token string double-quoted-string">&quot;order_id&quot;</span> <span class="token operator">=&gt;</span> <span class="token variable">$order</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//Stap 3 sla het payment ID op in je order</span>
    <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'orders'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token variable">$order</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'payment_id'</span> <span class="token operator">=&gt;</span> <span class="token variable">$payment</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//Stap 4 stuur de gebruiker door naar de Mollie betaalpagina</span>
    <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token variable">$payment</span><span class="token operator">-&gt;</span><span class="token function">getCheckoutUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">303</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>Hierna wordt de gebruiker doorgestuurd naar de Mollie betaalpagina. Na succesvolle betaling wordt de gebruiker teruggestuurd naar de <code>redirectUrl</code> die je hebt opgegeven.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">success</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token variable">$order_id</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'order_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$order</span> <span class="token operator">=</span> <span class="token class-name static-context">Order</span><span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token variable">$order_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$order</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/checkout'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Order not found.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$mollie</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MollieApiClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$mollie</span><span class="token operator">-&gt;</span><span class="token function">setApiKey</span><span class="token punctuation">(</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'services.mollie.key'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$payment</span> <span class="token operator">=</span> <span class="token variable">$mollie</span><span class="token operator">-&gt;</span><span class="token property">payments</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$order</span><span class="token operator">-&gt;</span><span class="token property">payment_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$status</span> <span class="token operator">=</span> <span class="token variable">$payment</span><span class="token operator">-&gt;</span><span class="token property">status</span> <span class="token operator">??</span> <span class="token string single-quoted-string">'unknown'</span><span class="token punctuation">;</span>
    <span class="token variable">$method</span> <span class="token operator">=</span> <span class="token variable">$payment</span><span class="token operator">-&gt;</span><span class="token property">method</span> <span class="token operator">??</span> <span class="token string single-quoted-string">'unknown'</span><span class="token punctuation">;</span>
    
    <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'orders'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token variable">$order</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'payment_status'</span> <span class="token operator">=&gt;</span> <span class="token variable">$status</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'payment_method'</span> <span class="token operator">=&gt;</span> <span class="token variable">$method</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$payment</span><span class="token operator">-&gt;</span><span class="token function">isPaid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'checkout.success'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'order'</span> <span class="token operator">=&gt;</span> <span class="token variable">$order</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/checkout'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Payment not completed.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>Vergeet niet van ook een webhook endpoint te maken. Een webhook is een manier voor Mollie om je applicatie te informeren over wijzigingen in de status van een betaling. Bijvoorbeeld wanneer de bezoeker kiest om te betalen via overschrijving, kan het enkele dagen duren voordat de betaling is voltooid. Mollie zal dan een verzoek sturen naar je webhook URL om je op de hoogte te stellen van de statuswijziging.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">webhook</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$mollie</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MollieApiClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$mollie</span><span class="token operator">-&gt;</span><span class="token function">setApiKey</span><span class="token punctuation">(</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'services.mollie.key'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$payment_id</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-&gt;</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$payment</span> <span class="token operator">=</span> <span class="token variable">$mollie</span><span class="token operator">-&gt;</span><span class="token property">payments</span><span class="token operator">-&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$payment_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$order</span> <span class="token operator">=</span> <span class="token class-name static-context">Order</span><span class="token operator">::</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payment_id'</span><span class="token punctuation">,</span> <span class="token variable">$payment_id</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$status</span> <span class="token operator">=</span> <span class="token variable">$payment</span><span class="token operator">-&gt;</span><span class="token property">status</span> <span class="token operator">??</span> <span class="token string single-quoted-string">'unknown'</span><span class="token punctuation">;</span>
    <span class="token variable">$method</span> <span class="token operator">=</span> <span class="token variable">$payment</span><span class="token operator">-&gt;</span><span class="token property">method</span> <span class="token operator">??</span> <span class="token string single-quoted-string">'unknown'</span><span class="token punctuation">;</span>
    
    <span class="token class-name static-context">DB</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'orders'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token variable">$order</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'payment_status'</span> <span class="token operator">=&gt;</span> <span class="token variable">$status</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'payment_method'</span> <span class="token operator">=&gt;</span> <span class="token variable">$method</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//Hieronder kan je nog extra acties uitvoeren, zoals het versturen van een bevestigingsmail</span>
<span class="token punctuation">}</span>    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Meer info over webhooks kan je vinden in de <a href="https://docs.mollie.com/reference/webhooks" target="_blank" rel="noopener noreferrer">Mollie documentatie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="test-credit-cards"><a href="#test-credit-cards" class="header-anchor">#</a> Test credit cards</h2> <p>Tijdens het ontwikkelen kan je gebruik maken van de volgende test credit card nummers:</p> <table><thead><tr><th>Brand</th> <th>Card number</th> <th>Expiry date</th> <th>CVV</th></tr></thead> <tbody><tr><td>American Express</td> <td>3782 822463 10005</td> <td>Any</td> <td>Any</td></tr> <tr><td>Mastercard</td> <td>2223 0000 1047 9399</td> <td>Any</td> <td>Any</td></tr> <tr><td>VISA</td> <td>4543 4740 0224 9996</td> <td>Any</td> <td>Any</td></tr></tbody></table> <p>Meer info over testing kan je vinden in de <a href="https://docs.mollie.com/reference/testing" target="_blank" rel="noopener noreferrer">Mollie documentatie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <div class="page-nav"><div class="inner"><a href="/laravel/laravel/how-to/e-mail.html" class="btn btn-left" data-v-67075f4c><svg fill="currentColor" class="icon bi" data-v-5390759e data-v-67075f4c><use xlink:href="/laravel/assets/img/bootstrap-icons.053b17c3.svg#arrow-left" data-v-5390759e></use></svg> Het versturen van e-mail <!----></a> <!----></div></div> <footer class="page-edit"><span class="copyright">Â© 2025 Arteveldehogeschool</span> <span class="last-updated"><span class="prefix">Laatst bijgewerkt:</span> <span class="time">4/11/2025 13:51:29</span></span> <!----></footer> </main></div><div class="global-ui"></div></div>
    <script src="/laravel/assets/js/app.9fc9bfe7.js" defer></script><script src="/laravel/assets/js/2.f4ff8d09.js" defer></script><script src="/laravel/assets/js/1.6dc52488.js" defer></script><script src="/laravel/assets/js/90.b9c6d33f.js" defer></script><script src="/laravel/assets/js/6.8ae372e2.js" defer></script><script src="/laravel/assets/js/21.a94f78e3.js" defer></script><script src="/laravel/assets/js/4.abda3fa6.js" defer></script>
  </body>
</html>
